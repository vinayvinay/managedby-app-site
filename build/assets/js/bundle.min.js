const UserDetection={_userType:null,_trafficSource:null,getUserType(){if(null!==this._userType)return this._userType;const e=document.referrer.toLowerCase(),t=window.location.search.toLowerCase();return e.includes("google.co")&&t.includes("international")?this._userType="international_landlord":e.includes("property")?this._userType="existing_landlord":t.includes("inherited")?this._userType="accidental_landlord":this._userType="unknown",this._userType},getTrafficSource(){if(null!==this._trafficSource)return this._trafficSource;const e=document.referrer.toLowerCase();return e.includes("google.")?this._trafficSource="google_ads":e.includes("facebook")?this._trafficSource="facebook":e.includes("linkedin")?this._trafficSource="linkedin":this._trafficSource=e?"referral":"direct",this._trafficSource},resetCache(){this._userType=null,this._trafficSource=null},getUserContext(){return{userType:this.getUserType(),trafficSource:this.getTrafficSource(),timestamp:Date.now(),url:window.location.href,referrer:document.referrer}}};window.UserDetection=UserDetection;const AnalyticsManager={config:{trackingId:"G-26Q381MZD0",conversionLabels:{lead_generation:"lead_generation"}},isLoaded:!1,init(){if(this.isLoaded)return;function e(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],window.gtag=e,e("js",new Date),e("config",this.config.trackingId);const t=document.createElement("script");t.async=!0,t.src=`https://www.googletagmanager.com/gtag/js?id=${this.config.trackingId}`,document.head.appendChild(t),this.isLoaded=!0,this.setupEventTracking(),this.setupScrollTracking()},trackEvent(e,t="cta_click",n=1){window.gtag&&"function"==typeof window.gtag&&gtag("event",t,{event_category:"engagement",event_label:e,value:n,user_type:UserDetection.getUserType(),traffic_source:UserDetection.getTrafficSource()})},trackConversion(e,t=1){window.gtag&&"function"==typeof window.gtag&&gtag("event","conversion",{send_to:`${this.config.trackingId}/${e}`,value:t,currency:"GBP",user_type:UserDetection.getUserType(),traffic_source:UserDetection.getTrafficSource()})},setupEventTracking(){[{selector:'a[href*="wa.me"]',label:"whatsapp"},{selector:'a[href*="calendly"]',label:"calendly"},{selector:'a[href*="mailto:"]',label:"email"}].forEach(e=>{document.querySelectorAll(e.selector).forEach(t=>{t.addEventListener("click",()=>{this.trackEvent(e.label),["whatsapp","calendly","email"].includes(e.label)&&this.trackConversion(this.config.conversionLabels.lead_generation)})})});const e=document.getElementById("open-modal");e&&e.addEventListener("click",()=>{this.trackEvent("modal_open")}),this.setupSectionTracking()},setupSectionTracking(){const e={},t=new IntersectionObserver(t=>{t.forEach(t=>{const n=t.target.id;if(t.isIntersecting)e[n]=Date.now();else if(e[n]){const t=Date.now()-e[n];t>1e3&&window.gtag&&"function"==typeof window.gtag&&gtag("event","section_engagement",{event_category:"engagement",event_label:n,value:Math.round(t/1e3)}),delete e[n]}})},{threshold:.5});["hero-section","how-we-are-different-section","how-can-we-help-section","cta-section"].forEach(e=>{const n=document.getElementById(e);n&&t.observe(n)})},setupScrollTracking(){const e=[25,50,75,90],t=[];let n;window.addEventListener("scroll",()=>{n||(n=setTimeout(()=>{(()=>{const n=Math.round(window.scrollY/(document.body.scrollHeight-window.innerHeight)*100);e.forEach(e=>{n>=e&&!t.includes(e)&&(t.push(e),window.gtag&&"function"==typeof window.gtag&&gtag("event","scroll_depth",{event_category:"engagement",event_label:`${e}_percent`,value:e}))})})(),n=null},250))})}};window.AnalyticsManager=AnalyticsManager;const HeroAnimationManager={init(e){sessionStorage.getItem("heroAnimationPlayed")?this.playReturnVisitAnimation(e):this.playFirstTimeAnimation(e)},playFirstTimeAnimation(e){document.querySelectorAll(".word-reveal-js").forEach(e=>{const t=1e3*parseFloat(e.dataset.delay);setTimeout(()=>{e.classList.add("animate")},t)}),sessionStorage.setItem("heroAnimationPlayed","true"),e&&setTimeout(e,4e3)},playReturnVisitAnimation(e){document.querySelectorAll(".word-reveal-js").forEach(e=>{parseFloat(e.dataset.delay)<2?(e.style.opacity="1",e.style.transform="translateY(0)"):setTimeout(()=>{e.style.opacity="1",e.style.transform="translateY(0)"},1e3)}),e&&setTimeout(e,2500)},resetAnimation(){sessionStorage.removeItem("heroAnimationPlayed"),document.querySelectorAll(".word-reveal-js").forEach(e=>{e.classList.remove("animate"),e.style.opacity="",e.style.transform=""})}};window.HeroAnimationManager=HeroAnimationManager;const StageSelector={stageButtons:null,serviceColumns:null,columns:null,init(){this.stageButtons=document.querySelectorAll(".stage-selector-btn"),this.serviceColumns=document.getElementById("service-columns"),this.columns=document.querySelectorAll(".service-column"),this.attachEventListeners(),this.handleStageSelection(1)},showColumns(e){this.columns.forEach(e=>{e.style.display="none"}),e.forEach(e=>{const t=document.querySelector(`[data-column="${e}"]`);t&&(t.style.display="flex")}),this.updateGridLayout(e.length)},updateGridLayout(e){this.serviceColumns.className=1===e?"grid grid-cols-1 gap-8 lg:gap-12 max-w-md mx-auto":2===e?"grid grid-cols-1 lg:grid-cols-2 gap-8 lg:gap-12 max-w-4xl mx-auto":"grid grid-cols-1 lg:grid-cols-3 gap-8 lg:gap-12"},handleStageSelection(e){this.stageButtons.forEach(e=>e.classList.remove("active"));const t=document.querySelector(`[data-stage="${e}"]`);switch(t&&t.classList.add("active"),e){case 1:default:this.showColumns([1,2,3]);break;case 2:this.showColumns([2,3])}},attachEventListeners(){this.stageButtons.forEach(e=>{e.addEventListener("click",()=>{const t=parseInt(e.getAttribute("data-stage"));this.handleStageSelection(t)})})}};window.StageSelector=StageSelector;const PrivacyManager={loadAnalytics(){window.AnalyticsManager&&window.AnalyticsManager.init()}};document.addEventListener("DOMContentLoaded",function(){const e=document.getElementById("privacy-banner");function t(){e&&(e.classList.remove("show"),e.classList.add("hide"),localStorage.setItem("privacyBannerDismissed","true"))}const n=document.querySelector(".privacy-btn-accept"),a=document.querySelector(".privacy-btn-decline");n&&n.addEventListener("click",function(){PrivacyManager.loadAnalytics(),t()}),a&&a.addEventListener("click",function(){t()}),HeroAnimationManager.init(function(){e&&!localStorage.getItem("privacyBannerDismissed")&&e.classList.add("show")}),StageSelector.init();({contactModal:document.getElementById("contact-modal"),privacyModal:document.getElementById("privacy-modal"),init(){document.getElementById("open-modal").addEventListener("click",()=>this.openContact()),document.getElementById("close-modal").addEventListener("click",()=>this.closeContact()),this.contactModal.addEventListener("click",e=>{e.target===this.contactModal&&this.closeContact()}),document.getElementById("open-privacy-modal").addEventListener("click",e=>{e.preventDefault(),this.openPrivacy()}),document.getElementById("close-privacy-modal").addEventListener("click",()=>this.closePrivacy()),this.privacyModal.addEventListener("click",e=>{e.target===this.privacyModal&&this.closePrivacy()}),document.addEventListener("keydown",e=>{"Escape"===e.key&&(this.contactModal.classList.contains("hidden")||this.closeContact(),this.privacyModal.classList.contains("hidden")||this.closePrivacy())})},openContact(){this.contactModal.classList.remove("hidden"),document.body.style.overflow="hidden"},closeContact(){this.contactModal.classList.add("hidden"),document.body.style.overflow="auto"},openPrivacy(){this.privacyModal.classList.remove("hidden"),document.body.style.overflow="hidden"},closePrivacy(){this.privacyModal.classList.add("hidden"),document.body.style.overflow="auto"}}).init()});